<mat-stepper [linear]="true">
	<!-- Informacion ciudadano -->

	<mat-step [stepControl]="ciudadanoForm" label="Informaci贸n del ciudadano">
		<form [formGroup]="ciudadanoForm">
			<!-- <ng-template matStepLabel>Informacion del ciudadano</ng-template> -->
			<div class="row">
				<mat-form-field style="width: 40%">
					<mat-label>Identificaci贸n</mat-label>
					<input matInput formControlName="identificacion" />
				</mat-form-field>
				<mat-form-field style="width: 40%">
					<mat-label>Nombre</mat-label>
					<input matInput formControlName="nombre" />
				</mat-form-field>
				<mat-form-field style="width: 40%">
					<mat-label>Apellido</mat-label>
					<input matInput formControlName="apellido" />
				</mat-form-field>
			</div>

			<div class="row-start">
				<fieldset style="width: 40%">
					<legend>Escoger Sexo</legend>
					<mat-radio-group
						aria-label="Select an option"
						formControlName="genero"
					>
						<mat-radio-button value="1" style="width: 20%"
							>Hombre</mat-radio-button
						>
						<mat-radio-button value="2" style="width: 20%"
							>Mujer</mat-radio-button
						>
					</mat-radio-group>
				</fieldset>
				<div class="col">
					<mat-checkbox
						formControlName="esExtranjero"
						style="margin-top: 1.5em"
						>Extranjero</mat-checkbox
					>
					<mat-form-field style="width: 100%">
						<mat-label>Telefono</mat-label>
						<input matInput formControlName="telefono" />
					</mat-form-field>
				</div>
			</div>
			<button
				style="width: 100%; margin-top: 1em"
				mat-raised-button
				color="accent"
				matStepperNext
			>
				Siguiente
			</button>
		</form>
	</mat-step>

	<!-- Informacion Vehiculo -->

	<mat-step [stepControl]="vehiculoForm" label="Informaci贸n vehiculo">
		<form [formGroup]="vehiculoForm">
			<div class="row-start">
				<mat-form-field
					appearance="fill"
					style="width: 40%"
					(click)="_cache.getData('VehiculoTipo')"
				>
					<mat-label>Tipo vehiculo</mat-label>
					<mat-select formControlName="vehiculoTipoId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.vehiculoTipos$ | async"
						>
							{{ item.nombre }}
						</mat-option>
					</mat-select>
				</mat-form-field>
				<mat-form-field
					appearance="fill"
					style="width: 40%"
					(click)="_cache.getData('VehiculoColores')"
				>
					<mat-label>Color</mat-label>
					<mat-select formControlName="vehiculoColorId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.vehiculoColor$ | async"
						>
							{{ item.nombre }}
						</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

			<div class="row">
				<mat-form-field
					appearance="fill"
					style="width: 40%"
					(click)="_cache.getData('VehiculoMarca')"
				>
					<mat-label>Marca</mat-label>
					<mat-select #marcaId formControlName="vehiculoMarcaId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.vehiculoMarca$ | async"
						>
							{{ item.nombre }}
						</mat-option>
					</mat-select>
				</mat-form-field>
				<mat-form-field
					appearance="fill"
					style="width: 40%"
					(click)="
						_cache.getDataOnId('VehiculoModelo', marcaId.value)
					"
				>
					<mat-label>Modelo</mat-label>
					<mat-select formControlName="vehiculoModeloId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.vehiculoModelo$ | async"
						>
							{{ item.nombre }}
						</mat-option>
					</mat-select>
				</mat-form-field>
				<mat-form-field style="width: 20%">
					<mat-label>Placa</mat-label>
					<input matInput formControlName="placa" />
				</mat-form-field>
			</div>
			<div class="row">
				<button style="width: 50%" mat-raised-button matStepperPrevious>
					Atras
				</button>
				<button
					style="width: 50%"
					mat-raised-button
					color="accent"
					matStepperNext
				>
					Siguiente
				</button>
			</div>
		</form>
	</mat-step>

	<!-- Informacion asistencia -->

	<mat-step [stepControl]="asistenciaForm" label="Informaci贸n asistencia">
		<form [formGroup]="asistenciaForm" (ngSubmit)="createAsistencia()">
			<div class="row">
				<mat-form-field
					appearance="fill"
					style="width: 50%"
					(click)="_cache.getData('provincias')"
				>
					<mat-label>Provincia</mat-label>
					<mat-select #provinciaId formControlName="provinciaId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.provincias$ | async"
							>{{ item.nombre }}</mat-option
						>
					</mat-select>
				</mat-form-field>
				<mat-form-field
					appearance="fill"
					style="width: 50%"
					(click)="
						_cache.getDataOnId('municipios', provinciaId.value)
					"
				>
					<mat-label>Municipio</mat-label>
					<mat-select formControlName="municipioId">
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.municipios$ | async"
							>{{ item.nombre }}</mat-option
						>
					</mat-select>
				</mat-form-field>
			</div>
			<div class="row">
				<!-- TODO: implement autocomplete -->
				<mat-form-field
					style="width: 30%"
					class="example-full-width"
					appearance="fill"
				>
					<mat-label>Asignar Unidad</mat-label>
					<input
						type="text"
						placeholder="Selecciona unidad"
						aria-label="Unidad-Miembro"
						matInput
						formControlName="unidadId"
						#unidad
						(change)="
							_unidades.getUnidadesAutoComplete(unidad.value)
						"
						[matAutocomplete]="auto"
					/>
					<mat-autocomplete
						autoActiveFirstOption
						#auto="matAutocomplete"
					>
						<mat-option
							*ngFor="
								let item of _unidades.unidadeAutocomplete$
									| async
							"
							[value]="item.unidadId"
						>
							<div>
								Den.: {{ item.denominacion }}
								<br />
								<small
									>Ficha: {{ item.ficha }} | Placa:
									{{ item.placa }}</small
								>
								<br />
								<small>Tramo: {{ item.tramo }}</small>
							</div>
						</mat-option>
					</mat-autocomplete>
				</mat-form-field>

				<mat-form-field appearance="fill" style="width: 20%">
					<mat-label>Categoria Asistencia</mat-label>
					<mat-select #categoriaAsistencia>
						<mat-option [value]="1">Accidente</mat-option>
						<mat-option [value]="2">Asistencia</mat-option>
					</mat-select>
				</mat-form-field>

				<mat-form-field
					appearance="fill"
					style="width: 50%"
					(click)="
						_cache.getDataOnId(
							'TipoAsistencia',
							categoriaAsistencia.value
						)
					"
				>
					<mat-label>Tipo Asistencia</mat-label>
					<mat-select
						formControlName="tipoAsistenciaId"
						[multiple]="true"
					>
						<mat-option
							[value]="item.id"
							*ngFor="let item of _cache.tipoAsistencia$ | async"
						>
							{{ item.nombre }}
						</mat-option>
					</mat-select>
				</mat-form-field>
			</div>

			<mat-form-field style="width: 100%">
				<mat-label>Comentarios</mat-label>
				<textarea
					formControlName="comentarios"
					matInput
					placeholder="comentarios..."
				></textarea>
			</mat-form-field>
			<div class="row">
				<button style="width: 50%" mat-raised-button matStepperPrevious>
					Atras
				</button>
				<button
					type="submit"
					style="width: 50%"
					mat-raised-button
					color="accent"
					[disabled]="!asistenciaForm.valid"
				>
					Terminar
				</button>
			</div>
		</form>
	</mat-step>
</mat-stepper>
